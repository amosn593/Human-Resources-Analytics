"0","# Loading libraries----"
"0","library(tidyverse)"
"0","library(recipes)"
"0","library(tidyquant)"
"0","library(ggrepel)"
"0","# Reading the data Set----"
"0","data <- read.csv(""hr.csv"",header = TRUE)"
"0","# variable work_accident, Left and Promotion_last_5years needs to refactored correctly ."
"0","data$Work_accident <- fct_recode(as.factor(data$Work_accident), No = ""0"", Yes = ""1"")"
"0","data$Left <- fct_recode(as.factor(data$Left),No = ""0"", Yes = ""1"")"
"0","data$Promotion_last_5years <- fct_recode(as.factor(data$Promotion_last_5years),No = ""0"","
"0","                                                   Yes = ""1"")"
"0","# Relevaling factor levels in salary variable"
"0","data$Salary <- fct_relevel(data$Salary, c(""low"", ""medium"", ""high""))"
"0","# Prepare Data ----"
"0","recipe_obj <- recipe(~., data = data) %>%"
"0","        step_discretize(all_numeric(),options = list(min_unique = 1)) %>%"
"0","        step_dummy(all_nominal(), one_hot = TRUE, naming = partial(dummy_names, sep = ""-""))%>%"
"0","        prep()"
"0","data_transformed <- data %>% bake(recipe_obj, new_data = .)"
"0","# Correlation Analysis----"
"0","data_corr <- data_transformed %>%"
"0","        cor(y = data_transformed$`Left-Yes`)%>%"
"0","        as_tibble(rownames = ""feature"") %>%"
"0","        rename(Left.Yes = V1) %>%"
"0","        separate(feature, into = c(""feature"",""bin""),sep = ""-"")%>%"
"0","        filter(!is.na(Left.Yes)) %>%"
"0","        filter(!str_detect(feature,""Left""))%>%"
"0","        arrange(abs(Left.Yes) %>% desc())%>%"
"0","        mutate(feature = as.factor(feature) %>% fct_rev())"
"0","# Visualize Correlation"
"0","data_corr %>% ggplot(aes(Left.Yes,feature,text=bin))+"
"0","        geom_vline(xintercept = 0,color=""red"",linetype = 2)+"
"0","        geom_point(color = ""#2c3e50"")+"
"0","        geom_text_repel(aes(label=bin),color = ""#2c3e50"",size =3)+"
"0","        expand_limits(x = c(-0.5,0.5))+"
"0","        theme_tq()+"
"0","        theme(plot.title = element_text(hjust = 0.5))+"
"0","        theme(plot.subtitle = element_text(hjust = 0.5))+"
"0","        labs(title = ""Human Resources Analytics"",subtitle ="
"0","                 ""Correlations to Employee Attrition"",y = """","
"0","             x = ""Correlation to Employee Attrition"")"
